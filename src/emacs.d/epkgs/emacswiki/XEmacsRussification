== Введение в Руссификацию ==
Emacs можно скомпилировать в двух основных вариантах: с Mule или без
Mule.  Русификация обоих вариантов кардинально различается и будет
рассмотрена каждая в своем разделе.

''Mule'' означает "MUlti Language Environment".  Это система поддержки
множества человеческих языков в рамках Emacs.  XEmacs/Mule
поддерживает множество различных кодировок, как одно-, так и
многобайтных.

[[XEmacs]] без Mule поддерживает лишь ''сырые'' восьмибитовые символы,
практически никак не интерпретируя их содержимое.  Из-за этого в
Xemacs без Mule можно редактировать только файлы в какой-нибудь одной
восьмибитной кодировке.  Однако, если вы постоянно пользуетесь,
например, кодировкой koi8-r, то можете безболезненно использовать
XEmacs без Mule.

Заметем что все нижесказанное так же с легкостью может расспространяться и на другие кирилические локализации, такие как украинский и другие.

При работе под X Window System рекомендуется настроить свою систему
так, чтобы использовалась ''честная'' кириллическая раскладка, то есть
xkb или xmodmap настроены так, что возвращают Cyrillic_XXX, а не
Aacute и т. п.

=== Настройка кириллических шрифтов под X Window System ===

Напишите в вашем файле <code>~/.Xresources</code> или <code>~/.Xdefaults</code> (заменив имена шрифтов на нужные):

    Emacs.default.attributeFont: -adobe-courier-medium-r-*-*-14-*-75-75-*-*-koi8-1
    Emacs.bold.attributeFont: -adobe-courier-bold-r-*-*-14-*-75-75-*-*-koi8-1
    Emacs.bold-italic.attributeFont: -adobe-courier-bold-o-*-*-14-*-75-75-*-*-koi8-1
    Emacs.italic.attributeFont: -adobe-courier-medium-o-*-*-14-*-75-75-*-*-koi8-1
    Emacs*menubar*font: -adobe-helvetica-bold-r-*-*-12-*-75-75-*-*-koi8-1

главное чтобы в шрифтах содержались глифы русских букв.

=== Кириллизация XEmacs с Mule под X Window System ===

Возьмите XEmacs 21.4.4.  Более старые версии так или иначе не работают
в отношении кириллицы под Mule.

Напишите в ~/.xemacs/init.el:

    (set-language-environment 'Cyrillic-KOI8)

Если вы используете честную кириллическую раскладку, то не требуется
включать никаких input-methods: они нужны в основном тогда, когда
базовая операционная система не умеет давать XEmacs'у ничего, кроме
ASCII-символов, и приходится следить за раскладкой на уровне XEmacs.

Если вы используете шрифты в кодировке koi8-r, то нужно добавить в
~/.xemacs/init.el:

    (set-charset-ccl-program 'cyrillic-iso8859-5 'ccl-encode-koi8-r-font)
    (set-charset-registry 'ascii "koi8-r")
    (set-charset-registry 'cyrillic-iso8859-5 "koi8-r")

Если вы используете шрифты в кодировке iso8859-5, то ничего добавлять
не надо.

<b>BUGS<b>:
* При переключении раскладки будет раздаваться противный писк, а в
мини-буфере появляется сообщение "iso-next-group not defined".  Будет
исправлено.

** fix: Если вам совсем это надоело можно добавить что то типа <code>(global-set-key [iso-next-group] (lambda () (interactive)))</code> или можно использовать функцию <code>`ru-keys-noop'</code> из пакета [http://www.bcs.zp.ua/~awn/xemacs/ru-keys.el ru-keys]

* Невозможно посмотреть с помощью клавиш C-h k, какая функция
привязана к кириллическим клавишам, потому что оно подхватывает
"клавишу" iso-next-group, тогда как должна её игнорировать.  Будет
исправлено.

** fix: смотрите предыдущую проблему

* Не работает копирование и вставка мышью текста в XEmacs и из
XEmacs'а.  Будет исправлено.

** fix: У меня на 21.1.14 без Mule подобное не наблюдается(все работает нормально) так что тут я не знаю.


=== Кириллизация XEmacs без Mule под X Window System ===

Возьмите последнюю версию XEmacs, например, 21.4.4.

В версиях 21.1.x не работают функции преобразования регистра типа
<code>`upcase-region-or-word'</code>, а также поиск с игнорированием регистра, так как используются так называемые ''синтаксические таблицы''(EmacsSyntaxTable) которые ''не вкурсе'' того что вы используете русский.

Поставьте дополнительный пакет [http://www.bcs.zp.ua/~awn/xemacs/ru-keys.el ru-keys].

Поместите его в какое-нибудь место, указанное в переменной
<code>`load-path'</code>, и добавьте в свой <code>~/.emacs</code> или <code>~/.xemacs/init.el</code>:

    (require 'ru-keys)

Теперь при нажатии на русскую букву в буфер будет помещаться
соответствующий символ в кодировке koi8-r.  Заметьте, что если вы
перекодируете файл ru-keys.el в другую кодировку (например, в
windows-1251), то символы в буфере будут именно в этой кодировке.

Кроме того, этот пакет правильно настраивает таблицы соответствия
прописных и строчных букв, а также ''синтаксические таблицы''(EmacsSyntaxTable), что
позволяет правильно работать функциям типа <code>`forward-word'</code>.

----
[[КатегорияРуссификация]]
